# Task 02: Packet Sniffing, Firewall Configuration, and Vulnerability Scanning

## Environment & Tools
- OS: Kali Linux (Virtual Machine)
- Language: Python 3
- Packet Sniffing: Scapy
- Firewall: iptables
- Vulnerability Scanning: OpenVAS (Greenbone)
- Visualization: Matplotlib

---

## Phase 1: Packet Sniffing (Scapy)

### Objective
- Capture and analyze live network traffic
- Identify protocol distribution (TCP, UDP, ICMP)
- Build visibility into real-time network behavior

### Execution
- Custom Python script: `packet_sniffer.py`
- Captured exactly 100 packets
- Identified protocol type per packet
- Counted protocol distribution

### Packet Capture Result
```
TCP   : 71
UDP   : 29
ICMP  : 0
```

### Observations
- TCP dominated due to web browsing (HTTP/HTTPS)
- UDP generated by DNS and background services
- ICMP absent due to no diagnostic traffic during capture

### Visualization
- Protocol distribution visualized using a bar chart
- TCP highest, UDP moderate, ICMP zero

---

## Phase 2: Firewall Configuration (iptables)

### Objective
- Implement a default-deny firewall
- Allow only essential services
- Understand rule order and stateful behavior

### Firewall Design
- Allow loopback traffic
- Allow established and related connections
- Allow SSH (22) and HTTP (80)
- Drop all other incoming traffic

### Key Rules Applied
```bash
sudo iptables -A INPUT -i lo -j ACCEPT
sudo iptables -A INPUT -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT
sudo iptables -A INPUT -p tcp --dport 22 -j ACCEPT
sudo iptables -A INPUT -p tcp --dport 80 -j ACCEPT
sudo iptables -P INPUT DROP
```

### Validation
- HTTP traffic allowed successfully
- ICMP temporarily blocked to prove rule effectiveness
- Rule order verified using verbose listing

### Key Findings
- Rule order directly impacts firewall behavior
- ESTABLISHED rules allow return traffic
- Default-deny policy significantly reduces attack surface

---

## Phase 3: Vulnerability Scanning (OpenVAS)

### Objective
- Perform vulnerability assessment on local system
- Understand scanner setup and real-world limitations

### Setup Performed
- Installed and initialized OpenVAS
- Created admin user and verified services
- Accessed Greenbone web interface
- Configured scan target: `127.0.0.1`

### Issue Encountered
- Scan execution blocked due to feed synchronization error
- Default scan configuration unavailable

### Troubleshooting Attempted
- Restarted OpenVAS services
- Verified feed sync status
- Attempted database and cache rebuild
- Changed VM networking (NAT → Bridged)
- Considered VPN-based feed access

### Outcome
- Scan could not be executed due to feed lock issues
- Limitation documented instead of forcing unstable fixes

---

## Challenges & Troubleshooting
- Python package restrictions on Kali → solved using virtual environment
- Firewall ICMP behavior → resolved by understanding rule priority
- OpenVAS feed synchronization → documented as operational limitation

---

## Files Included
```
├── packet_sniffer.py
├── firewall_rules.txt
├── protocol_distribution.png
├── openvas_setup_notes.txt
└── README.md
```

---

## Key Learnings
- Network traffic depends on system activity and timing
- Packet visibility is foundational for threat detection
- Firewall security depends on rule order, not just rules
- Default-deny is a strong baseline defense
- Security tools have real-world operational limits
- Clear documentation is critical in SOC operations

---

## Conclusion
This task provided hands-on experience across packet analysis, firewall hardening, and vulnerability management. It demonstrated how defensive security workflows operate in real environments, including tool limitations, troubleshooting, and evidence-based documentation—core skills for SOC and defensive security roles.

---

## Disclaimer
All activities were performed in an authorized, isolated lab environment for educational purposes only.
